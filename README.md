##stock-analysis


###Overview of Project


A colleague named Steve asked for assistance with analyzing stock information.  His parents were investing in a particular stock (DQ) and he need help to analyze two years of DQ stock data to see if it was beneficial investment for his parents.  After the initial DQ analysis, he requested a few more stocks to be analyzed.  He was impressed with the results and asked for an analysis of the entire stock market over the last few years.  With a larger dataset, refactoring code would be helpful in providing results more timely and efficiently.

###Results


According to the data analysis, the overall stock performance fared better in 2017 than compared to 2018.  More specifically, DQâ€™s stock performed well in 2017, resulting in a 199.4% return.  However, in 2018, it returned at a loss of 62.6%.  Overall, 2018 was not a good investment year.  Only two stocked earned profitable returns in 2018: ENPH & RUN.


![All Stock 2017 Data Set](https://user-images.githubusercontent.com/101373142/160268128-146054dc-4ba8-4dad-84d2-bc8d3449f5ba.png)                  

![All Stock 2018 Data Set](https://user-images.githubusercontent.com/101373142/160268136-8eccde1c-01a7-4046-aee4-bdbfeba927e3.png)


By refactoring the script for this data analysis, I was able to execute and produce results quicker that the original script.  By revising and modifying the codes, executing times improved. Refactoring resulted in the data analysis execution time for the year 2018 to improve dramatically.  





Execution Time with Original Script

![All Stock 2017 - Timer Initial Coding before Refactor](https://user-images.githubusercontent.com/101373142/160268167-136df2f6-f823-457c-bcb7-9e55245e9463.png)




Execution Time with Refactored Script


![VBA_Challenge_2017](https://user-images.githubusercontent.com/101373142/160268182-f88f493a-0c90-4045-be1d-9c81e57f31b8.png)





Execution Time with Original Script

![All Stock 2018 - Timer Initial Coding before Refactor](https://user-images.githubusercontent.com/101373142/160268189-7f434b85-d090-43e3-9515-078f383a58d2.png)





Execution Time with Refactored Script


![VBA_Challenge_2018](https://user-images.githubusercontent.com/101373142/160268194-3f9d7b09-cc7d-4f90-83b0-dda6299bca87.png)




Refactored Code


![Refactored VBA Code](https://user-images.githubusercontent.com/101373142/160268201-a4fd0a1a-e5ec-4c85-8a43-b623944af222.png)






###Ending Summary



An advantage of refactoring is shortening script and removing duplicate code in various places.   A disadvantage of refactoring results is a lot of time spent retesting code, possibly affecting testing outcomes.
These pros and cons apply to the refactoring of the original VBA script because it was time consuming and there was a lot of trial and error during the process.  However, I was able to remove duplicate code, that was not initially needed.  Refactoring and restructuring the script in small steps resulted in a much more efficient product and improved performance.  
